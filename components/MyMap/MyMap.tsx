import { NavigationProp, useNavigation, useRoute } from "@react-navigation/native"
import * as React from "react"
import MapView, { PROVIDER_GOOGLE } from "react-native-maps"
import { MapData } from "src/types"
import ErrorBoundary from "../ErrorBoundry"
import JCComponent from "../JCComponent/JCComponent"

interface Props {
  navigation?: NavigationProp<any, any>
  route?: any
  visible: boolean
  mapData: MapData[]
  type: string
  initCenter?: any
  size?: string
}
class MyMapImpl extends JCComponent<Props> {
  constructor(props: Props) {
    super(props)
  }
  mapstyle = [
    {
      elementType: "geometry",
      stylers: [
        {
          color: "#f5f5f5",
        },
      ],
    },
    {
      elementType: "labels.icon",
      stylers: [
        {
          visibility: "off",
        },
      ],
    },
    {
      elementType: "labels.text.fill",
      stylers: [
        {
          color: "#616161",
        },
      ],
    },
    {
      elementType: "labels.text.stroke",
      stylers: [
        {
          color: "#f5f5f5",
        },
      ],
    },
    {
      featureType: "administrative.land_parcel",
      elementType: "labels.text.fill",
      stylers: [
        {
          color: "#bdbdbd",
        },
      ],
    },
    {
      featureType: "poi",
      elementType: "geometry",
      stylers: [
        {
          color: "#eeeeee",
        },
      ],
    },
    {
      featureType: "poi",
      elementType: "labels.text.fill",
      stylers: [
        {
          color: "#757575",
        },
      ],
    },
    {
      featureType: "poi.park",
      elementType: "geometry",
      stylers: [
        {
          color: "#e5e5e5",
        },
      ],
    },
    {
      featureType: "poi.park",
      elementType: "labels.text.fill",
      stylers: [
        {
          color: "#9e9e9e",
        },
      ],
    },
    {
      featureType: "road",
      elementType: "geometry",
      stylers: [
        {
          color: "#ffffff",
        },
      ],
    },
    {
      featureType: "road.arterial",
      elementType: "labels.text.fill",
      stylers: [
        {
          color: "#757575",
        },
      ],
    },
    {
      featureType: "road.highway",
      elementType: "geometry",
      stylers: [
        {
          color: "#dadada",
        },
      ],
    },
    {
      featureType: "road.highway",
      elementType: "labels.text.fill",
      stylers: [
        {
          color: "#616161",
        },
      ],
    },
    {
      featureType: "road.local",
      elementType: "labels.text.fill",
      stylers: [
        {
          color: "#9e9e9e",
        },
      ],
    },
    {
      featureType: "transit.line",
      elementType: "geometry",
      stylers: [
        {
          color: "#e5e5e5",
        },
      ],
    },
    {
      featureType: "transit.station",
      elementType: "geometry",
      stylers: [
        {
          color: "#eeeeee",
        },
      ],
    },
    {
      featureType: "water",
      elementType: "geometry",
      stylers: [
        {
          color: "#c9c9c9",
        },
      ],
    },
    {
      featureType: "water",
      elementType: "labels.text.fill",
      stylers: [
        {
          color: "#9e9e9e",
        },
      ],
    },
  ]
  render(): React.ReactNode {
    if (this.props.visible)
      return (
        <ErrorBoundary>
          <MapView
            provider={PROVIDER_GOOGLE}
            customMapStyle={this.mapstyle}
            showsUserLocation={true}
            style={{ height: 250 }}
            initialRegion={{
              latitude: 43.78825,
              longitude: -78.4324,
              latitudeDelta: 6,
              longitudeDelta: 6,
            }}
          ></MapView>
        </ErrorBoundary>
      )
    else return null
  }
}

export default function MyMap(props: Props): JSX.Element {
  const route = useRoute()
  const navigation = useNavigation()
  return <MyMapImpl {...props} navigation={navigation} route={route} />
}
